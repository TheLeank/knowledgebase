"use strict";(self.webpackChunkkb=self.webpackChunkkb||[]).push([[281],{3905:function(e,r,n){n.d(r,{Zo:function(){return d},kt:function(){return p}});var a=n(7294);function t(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function o(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?o(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function l(e,r){if(null==e)return{};var n,a,t=function(e,r){if(null==e)return{};var n,a,t={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)>=0||(t[n]=e[n]);return t}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var s=a.createContext({}),c=function(e){var r=a.useContext(s),n=r;return e&&(n="function"==typeof e?e(r):i(i({},r),e)),n},d=function(e){var r=c(e.components);return a.createElement(s.Provider,{value:r},e.children)},u={inlineCode:"code",wrapper:function(e){var r=e.children;return a.createElement(a.Fragment,{},r)}},m=a.forwardRef((function(e,r){var n=e.components,t=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),m=c(n),p=t,h=m["".concat(s,".").concat(p)]||m[p]||u[p]||o;return n?a.createElement(h,i(i({ref:r},d),{},{components:n})):a.createElement(h,i({ref:r},d))}));function p(e,r){var n=arguments,t=r&&r.mdxType;if("string"==typeof e||t){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var s in r)hasOwnProperty.call(r,s)&&(l[s]=r[s]);l.originalType=e,l.mdxType="string"==typeof e?e:t,i[1]=l;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4639:function(e,r,n){n.r(r),n.d(r,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return d},default:function(){return m}});var a=n(7462),t=n(3366),o=(n(7294),n(3905)),i=["components"],l={title:"Linux",slug:"/"},s=void 0,c={unversionedId:"linux",id:"linux",isDocsHomePage:!1,title:"Linux",description:"Eliminar ficheros por marca de tiempo",source:"@site/docs/linux.md",sourceDirName:".",slug:"/",permalink:"/",editUrl:"https://github.com/TheLeank/knowledgebase/edit/master/docs/linux.md",version:"current",frontMatter:{title:"Linux",slug:"/"},sidebar:"someSidebar",next:{title:"VirtualBox",permalink:"/virtualbox"}},d=[{value:"Eliminar ficheros por marca de tiempo",id:"eliminar-ficheros-por-marca-de-tiempo",children:[{value:"Usando minutos",id:"usando-minutos",children:[]},{value:"Usando d\xedas",id:"usando-d\xedas",children:[]}]},{value:"Eliminar ficheros de directorio muy lleno",id:"eliminar-ficheros-de-directorio-muy-lleno",children:[{value:"Evitando carga del servidor",id:"evitando-carga-del-servidor",children:[]}]},{value:"Rsync",id:"rsync",children:[{value:"Hacia otro servidor",id:"hacia-otro-servidor",children:[]}]},{value:"Reemplazar texto en ficheros con sed",id:"reemplazar-texto-en-ficheros-con-sed",children:[]},{value:"Modificar zona horaria",id:"modificar-zona-horaria",children:[]},{value:"Ver los 10 procesos que m\xe1s memoria consumen",id:"ver-los-10-procesos-que-m\xe1s-memoria-consumen",children:[]},{value:"Eliminar directorio con excepciones",id:"eliminar-directorio-con-excepciones",children:[]},{value:"A\xf1adir binarios a PATH",id:"a\xf1adir-binarios-a-path",children:[{value:"Temporalmente",id:"temporalmente",children:[]},{value:"Permanentemente",id:"permanentemente",children:[]}]},{value:"Usar la misma zona horaria en dualboot",id:"usar-la-misma-zona-horaria-en-dualboot",children:[]},{value:"Cambiar de directorio tras conectar v\xeda ssh",id:"cambiar-de-directorio-tras-conectar-v\xeda-ssh",children:[]},{value:"XRDP",id:"xrdp",children:[{value:"Conectar a una sesi\xf3n existente",id:"conectar-a-una-sesi\xf3n-existente",children:[]}]}],u={toc:d};function m(e){var r=e.components,n=(0,t.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},u,n,{components:r,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"eliminar-ficheros-por-marca-de-tiempo"},"Eliminar ficheros por marca de tiempo"),(0,o.kt)("p",null,"Eliminamos, en el directorio actual y recursivamente, ficheros anteriores al tiempo indicado"),(0,o.kt)("h3",{id:"usando-minutos"},"Usando minutos"),(0,o.kt)("p",null,"1440 minutos son 24 horas"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"/usr/bin/find ${PWD}/* -mmin +1440 -exec rm -rf {} \\;\n")),(0,o.kt)("h3",{id:"usando-d\xedas"},"Usando d\xedas"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"/usr/bin/find ${PWD}/* -mtime +7 -exec rm -rf {} \\;\n")),(0,o.kt)("h2",{id:"eliminar-ficheros-de-directorio-muy-lleno"},"Eliminar ficheros de directorio muy lleno"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"find ./ -name '*' -print0 | xargs -0 -n 10 rm\n")),(0,o.kt)("h3",{id:"evitando-carga-del-servidor"},"Evitando carga del servidor"),(0,o.kt)("p",null,"Con ionice limitamos la ejecuci\xf3n del comando de manera que se vaya ejecutando mientras no haya otros procesos usando el disco, de manera que para discos mec\xe1nicos puede resultar \xfatil."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ionice -c 3 find ${PWD}/* -type f -print -delete\n")),(0,o.kt)("h2",{id:"rsync"},"Rsync"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"rsync -arzvl ${PWD}/ /ruta/destino/\n")),(0,o.kt)("h3",{id:"hacia-otro-servidor"},"Hacia otro servidor"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"rsync -arzvl -e ssh ${PWD}/ root@IPSERVER:/ruta/destino/\n")),(0,o.kt)("p",null,"En caso de que el servidor al que queremos transferir la informaci\xf3n no tenga el puerto ssh por defecto, usamos:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"rsync -arzvl -e ssh --rsh='ssh -p1234' ${PWD}/ root@IPSERVER:/ruta/destino/\n")),(0,o.kt)("h2",{id:"reemplazar-texto-en-ficheros-con-sed"},"Reemplazar texto en ficheros con sed"),(0,o.kt)("p",null,"La s inicial significa sustituir, mientras la g final significa global (de manera que sed no se detenga en la primera coincidencia)"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sed -i 's/find/replace/g' FICHERO\n")),(0,o.kt)("h2",{id:"modificar-zona-horaria"},"Modificar zona horaria"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"rm /etc/localtime\nln -s /usr/share/zoneinfo/Europe/Madrid /etc/localtime\n")),(0,o.kt)("h2",{id:"ver-los-10-procesos-que-m\xe1s-memoria-consumen"},"Ver los 10 procesos que m\xe1s memoria consumen"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ps aux | awk '{print $2, $4, $11}' | sort -k2r | head -n 10\n")),(0,o.kt)("h2",{id:"eliminar-directorio-con-excepciones"},"Eliminar directorio con excepciones"),(0,o.kt)("p",null,"Usando GLOBIGNORE podemos eliminar un directorio completo con rm -rf * conservando el contenido deseado"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"export GLOBIGNORE=*.php:*.sql:.vs-code\n")),(0,o.kt)("p",null,"Recuerda que la variable se declara para la sesi\xf3n actual."),(0,o.kt)("h2",{id:"a\xf1adir-binarios-a-path"},"A\xf1adir binarios a PATH"),(0,o.kt)("h3",{id:"temporalmente"},"Temporalmente"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'PATH="/path/to/include:$PATH"\n')),(0,o.kt)("p",null,"Debido a que se ejecuta el primer binario encontrado, dejamos $PATH al final de la cadena para los casos en que el binario que queremos ejecutar ya existe en el sistema"),(0,o.kt)("p",null,"Si queremos que el binario tambi\xe9n pueda ser ejecutado fuera de la consola, ejecutamos a continuaci\xf3n:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"export PATH\n")),(0,o.kt)("h3",{id:"permanentemente"},"Permanentemente"),(0,o.kt)("p",null,"Tendremos que editar el fichero .profile ","[.bashrc, .bash_rc o .bash_profile]"," de nuestro directorio home y a\xf1adir las dos l\xedneas anteriores en el mismo orden."),(0,o.kt)("h2",{id:"usar-la-misma-zona-horaria-en-dualboot"},"Usar la misma zona horaria en dualboot"),(0,o.kt)("p",null,"Windows y Linux obtienen la hora de diferente manera. La v\xeda m\xe1s sencilla de hacer que ambos SO tengan la misma hora es hacer que Linux cambie su comportamiento."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"timedatectl set-local-rtc 1 --adjust-system-clock\n")),(0,o.kt)("p",null,"Para deshacerlo:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"timedatectl set-local-rtc 0 --adjust-system-clock\n")),(0,o.kt)("p",null,"Podemos comprobar el valor actual con:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"timedatectl\n")),(0,o.kt)("h2",{id:"cambiar-de-directorio-tras-conectar-v\xeda-ssh"},"Cambiar de directorio tras conectar v\xeda ssh"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-none",metastring:'title="~/.ssh/config"',title:'"~/.ssh/config"'},"Host example.net\n    RemoteCommand cd / && exec bash --login\n    RequestTTY yes\n")),(0,o.kt)("h2",{id:"xrdp"},"XRDP"),(0,o.kt)("h3",{id:"conectar-a-una-sesi\xf3n-existente"},"Conectar a una sesi\xf3n existente"),(0,o.kt)("p",null,"Al intentar conectar a una sesi\xf3n existente, la pantalla se muestra en negro y un segundo despu\xe9s, se cierra:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-none"},"echo xfce4-session > $HOME/.xsession\nchmod +x .xsession\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/neutrinolabs/xrdp/issues/1412"},"Issue en github")))}m.isMDXComponent=!0}}]);